# 暖宅
一个智能家居项目

# 市场调研
目标用户： 
  - 年龄：23-60
  - 收入  
使用场景和偏好等特征，通过问卷、访谈或线下调研等方式收集用户对智能家居各类产品的购买意愿、使用频率和需求场景  

用户画像：
- 年轻科技爱好者
  - 关注的功能：
  - 痛点：
- 家庭主妇
  - 关注的功能：
  - 痛点：
- 老年陪护
  - 关注的功能：
  - 痛点：  

竞品分析：
- 小米 
  - 功能
  - 价格
  - 设计定位
  - 市场表现  
总结：竞品在智能灯光、安防、家电控制等方面的技术方案与市场反馈，分析其优势和不足  

- 华为
  - 功能
  - 价格
  - 设计定位
  - 市场表现  

研究竞品的市场定位、营销渠道和市场份额，为自身产品定位、差异化竞争提供参考。
市场规模与趋势： 评估智能家居行业的市场容量和增长速度，关注细分场景（如安防、照明、家电控制、健康监测等）的需求占比和趋势  

收集权威行业报告和统计数据，判断目标市场潜力及竞争格局。分析政策导向、技术趋势（如5G、AIoT）对市场的影响，为确定产品方向和商业模式提供决策依据。
通过上述调研，形成完整的市场分析报告和需求说明，明确产品的目标用户、差异化定位和关键功能。这些成果（如产品需求文档、市场报告）将作为后续立项和设计的基础

# 产品定义，技术可行性评估
产品需求文档（PRD）列出功能需求、性能指标及商用目标。然后开展技术可行性分析

技术需求分析： 
- 明确项目所需的硬件平台、通信协议、软件算法和接口规范等
- 确定使用何种MCU芯片、无线模块、传感器类型。

技术资源评估： 
- 检查现有团队和资源是否满足需求，包括开发工具链、算法库、供应商支持等
- 评估团队在相关领域的经验和能力（如嵌入式开发、AI 算法、云平台开发等），如有缺口需考虑外部合作或引入人才。

技术方案对比： 比较不同实现方案，如Wi-Fi vs ZigBee通信、单板 vs 多板方案、单芯片 vs 多芯片等，对成本、功耗、扩展性、复杂度进行权衡

# 方案评估
- web
  - 成熟：成熟
  - 可控：可控
- 只软件

# 风险评估
- 技术难题
  - 实时性
- 算法复杂度
  - 基本没有
- 跨平台兼容性
  - 项目周期和质量的影响

# 成本评估
- 研发
  - 硬件
  - 软件
- 生产
  - 厂商

# 时间评估
- 研发

- 测试

- 生产

# 收益评估
1500万

# 项目架构
见docs目录中的architecture中的架构图

# 代码结构
doc - 文档  
embedded_apps - 嵌入式应用层  
embedded_backend - 嵌入式后端  
embedded_common - 嵌入式公共代码  
embedded_drivers - 嵌入式驱动  
embedded_server - boa源码  
web_frontend - web前端页面  
web_frontend_mini_program - 小程序(后续支持)  
web_backend - web java后端服务器(后续支持)  

# 项目技术栈
嵌入式服务端
- C++ boa cjson 消息队列 共享内存  

嵌入式应用层  
- C++ 多线程 消息队列 共享内存 视频流  

嵌入式驱动层  
- C语言 Zigbee I2C ADC GPIO UART  

Web层  
- PC前台前端：react antd vite axios  
- PC后台前端：react antd vite axios  
- 小程序前端：react antd vite axios  
- 后端：java spring  

# 操作手册
见docs目录

# 问题总结
### cgi中使用JSON
安装cjson

### cgi中的缺少引用也不会报错，只会变成502看不出是什么引起
把所有警告弄好

### cgi中不能放while无限循环去接收消息
让前端去轮询

### cgi中无法使用websoket，给前端推送环境信息，且前端不是由cgi实现
使用轮询方式，后续优化将cgi换掉

### JSON通信响应格式不统一
创建统一格式的函数

### 各个端需要数据格式不一样
由服务端cgi层去转格式，前端不转，app层不转，驱动层更不可能转

### 硬件控制页，首次进去看不到硬件的状态，不知道硬件开了没
使用管道

### 编译器不同，对c99语法的支持会有问题
全部c代码都不使用随用随定义，c++代码可以写

### embedded_backend改造
使用现代web服务器路由

### 增加数据库
next

### c语言缺少一些方便的库
- 打印结构体
- 打印森林数组
- 缺少字符串截取函数

### 重复包含问题
用一个.h文件，全部放里面，不再拆分

### 消息体内容被回收问题
malloc